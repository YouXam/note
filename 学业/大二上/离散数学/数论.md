# 整除
$a|b \equiv \text{"a divides b"} :\equiv (\exists c \in \mathbf{Z}: ac = b)$
## 定理
### 1
$\forall a,b,c \in \mathbf{Z}$
1. $a|0$
2. $(a|b \land |a|c) \rightarrow a|(b+c)$ 且 $a|(mb+nc), \forall m,n \in \mathbf{Z}$
3. $a|b \rightarrow a|bc$
4. $(a|b \land b|c) \rightarrow a|c$
### 2
$\forall a,d \in \mathbf{Z}, d \neq 0: \exists q, r \in \mathbf{Z}: 0 \le r < |d|, a=dq+r$
$q$: 商数(quotient)，${\color{red} q = \lfloor a/d \rfloor} = a \ \text{div}\  d$
$r$: 余数(remainder)，${\color{red}r=a-qd}=a \mod d$
# 同余
本节中$a, b \in \mathbf{Z}, m \in \mathbf{Z}^+$
## 1
$a \equiv b\ (\mod m) \Leftrightarrow a(\mod m) \equiv b(\mod m) \Leftrightarrow \exists k \in \mathbf{Z},a=b+km$
## 2
若 $a \equiv b(\mod m)$且$c \equiv d(\mod m)$
则 $a+c \equiv b + d(\mod m)，ac\equiv bd(\mod m)$ (积同余且和同余)
## 3
$(a+b)\mod m=((a \mod m)+(b \mod m)) \mod m$
$(ab)\mod m=((a \mod m)(b \mod m)) \mod m$
# 模算术
$a +_{m} b=(a+b) \mod m$
$a \cdot_m b= (ab) \mod m$
# 模指数

快速幂

```cpp
int qpow(int a, int b, int p) {
	int ans = 1;
	while (b) {
		if (b & 1) ans = ans * a % p;
		a = a * a % p;
		b >>= 1;
	}
	return ans;
}
```

计算 $11^{644} \mod 645$：
$(644)_{10}=(1010000100)_2$

```plain
	    x=1, 	a=1
n[0]=0,	x=1, 	a=121
n[1]=0,	x=1, 	a=451
n[2]=1,	x=451, 	a=226
n[3]=0,	x=451, 	a=121
n[4]=0,	x=451, 	a=451
n[5]=0,	x=451, 	a=226
n[6]=0,	x=451, 	a=121
n[7]=1,	x=391, 	a=451
n[8]=0,	x=391, 	a=226
n[9]=1,	x=1, 	a=121
```
$11^{644} \mod 645=1$
# 质数
## 质数有无穷个
令$q=p_1p_2p_3 \cdots p_n+1$，则$q$是一个质数。
## 梅森质数
如果$2^p-1$是质数，则被称为梅森素数。
## 质数分布
不超过$x$的素数的个数近似为$\dfrac{x}{\ln(x)}$。
## 最大公因数(GCD)

(Greatest Common Divisor, GCD)

$d=\gcd(a,b)=\max(d:d|a \land d|b) \Leftrightarrow d|a \land d|b \land \forall e \in \mathbf{Z}: (e|a \land e|b) \rightarrow d\ge e$
$\gcd(a,b)=\dfrac{ab}{\text{lcm}(a,b)}$
若
$a=p_1^{a_1}p_2^{a_2}p_3^{a_3}\cdots p_n^{a_n}, b=p_1^{b_1}p_2^{b_2}p_3^{b_3}\cdots p_n^{b_n}$
则
$\gcd(a,b)=p_1^{\min(a_1,b_1)}p_2^{\min(a_2,b_2)}p_3^{\min(a_3,b_3)}\cdots p_n^{\min(a_n,b_n)}$
## 互质
$a$和$b$互质当且仅当$\gcd(a,b)=1$
## 最小公倍数(LCM)
(Least Common Multiple, LCM)
$d=\text{lcm}(a,b)=\min(d:a|m \land b|m) \Leftrightarrow a|m \land b|m \land \forall n \in \mathbf{Z}: (a|n \land b|n) \rightarrow m\le n$
$\text{lcm}(a,b)=\dfrac{ab}{\gcd(a,b)}$
若
$a=p_1^{a_1}p_2^{a_2}p_3^{a_3}\cdots p_n^{a_n}, b=p_1^{b_1}p_2^{b_2}p_3^{b_3}\cdots p_n^{b_n}$
则
$\text{lcm}(a,b)=p_1^{\max(a_1,b_1)}p_2^{\max(a_2,b_2)}p_3^{\max(a_3,b_3)}\cdots p_n^{\max(a_n,b_n)}$
## 欧几里得算法
$\gcd(a,b)=\gcd((a\mod b), b)$
## 扩展欧几里得算法(exgcd)
eg. 35, 78

1.
$78=2 \times 35+8$
$35=4\times8+3$
$8=2\times3+2$
$3=2\times3+2$
$2=2\times1+0$

2.
$1=3-1\times2$
$2=8-2\times3$
$3=35-4\times8$
$8=78-2\times35$

3.
$1=3-(8-2\times3)=3\times3-8=3\times3-78+2\times35=3\times(35-4\times8)-78+2\times35$
$=5\times35-12\times8-78=5\times35-12\times(78-2\times35)-78=29\times35-13\times78$

## 其他相关定理
### 1.
若 $\gcd(a, b)=1$ 且 $a | bc$，则 $a|c$ 。
### 2.
若 $ac\equiv bc(\mod m)$ 且 $\gcd(c,m)=1$，则 $a \equiv b(\mod m)$
### 3.
如果 $p$ 是质数并且 $p|a_1a_2 \cdots a_n$，则 $\exists i: p|a_i$

# 模逆元

$a a^{-1} \equiv 1(\mod m)$，$a^{-1}$ 称为模 $m$ 意义下 $a$ 的逆。
## 费马小定理

如果 $m$ 是质数， $a^{m-2}\equiv a^{-1}(\mod m)$。
## 扩展欧几里得定理

当 $a$ 和 $m$ 互质，$\gcd(a, m) = 1$, 有 $sa+tm=1$ （贝祖系数法），因此 $sa \equiv 1(\mod m)$。此时 $s=a^{-1}$。
故先用 $a$ 和 $m$ 线性表示 1。

例1. 上文中 $35 \times 29 \equiv 1(\mod 78 \text{ 或} \mod 13)$。

例2. 求 144 在模 233 意义下的逆元。
使用扩展欧几里得用两个数字表示 1：
$1 = 89 \times 144 - 55 \times 233$
故 $144^{-1}\equiv89 (\mod 233)$
